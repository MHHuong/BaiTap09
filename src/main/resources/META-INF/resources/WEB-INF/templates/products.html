<!doctype html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Products by Price</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
</head>
<body class="container py-4">
<h3>Sản phẩm (giá tăng dần)</h3>
<table class="table" id="tblProducts">
    <thead><tr><th>#</th><th>Title</th><th>Price</th><th>Owner</th></tr></thead>
    <tbody></tbody>
</table>

<script>
    async function loadProducts(){
        const query = `query {
    productsByPriceAsc { id title price user { fullname } }
  }`;
        const res = await fetch('/graphql', {
            method:'POST', headers:{'Content-Type':'application/json'},
            body: JSON.stringify({ query })
        });
        const json = await res.json();
        const rows = (json.data && json.data.productsByPriceAsc) ? json.data.productsByPriceAsc : [];
        const tbody = document.querySelector('#tblProducts tbody');
        tbody.innerHTML = rows.map((p,i)=>`
     <tr>
       <td>${i+1}</td>
       <td>${p.title??''}</td>
       <td>${p.price??''}</td>
       <td>${p.user?.fullname??''}</td>
     </tr>`).join('');
    }
    loadProducts();
</script>
</body>
</html>